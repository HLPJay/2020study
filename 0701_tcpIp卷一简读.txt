1：7 应用层 6 表示层 5 会话层 4 传输层 3 网络层 2 数据链路层 1 物理层 
2：描述符的概念及流程 pcb
3：mbuf  ==》存储器缓存 簇   netstat -m
4：中断
5：m_pullup实现的分片和重组===》实现ip分片重组
6：ifnet ifaddr  接口层   ===>每一个网络接口，用链式ifnet存储
	网络初始化，硬件初始化和接口协议初始化。 ==》串口初始化
	链路层地址==》初始化，存储，掩码
7：以太网，初始化及发送接收  ioctl函数
	以太网接口驱动程序
	ARP：IP与硬件地址的转换







协议：
地址解析协议：arp
dhcp和自动配置
ICMP协议的功能主要有：  ==》确保网络通畅
1. 确认IP包是否成功到达目标地址 
2. 通知在发送过程中IP包被丢弃的原因
DNS：名称解析，域名系统
tcp：传输控制协议   arq和重传， 超时重传，    数据流和窗口管理（延时ACK和Nagle算法） tcp拥塞控制 rto处理 tcp保活

物理层
数据链路层： arp（以太网 wifi）==》ip层使用的地址和链路层使用地址的转换
网络层： ip， ICMP IGMP IPsec
传输层： tcp/udp
应用层

端主机实现所有层，路由器实现传输层下的层
PDU 消息对象  ip发给链路层的PDU ==》ip数据报，大小64KB
32位的ipv4   128位的ipv6
ping和traceroute使用ICMP协议，网络层
传输层：传输控制协议 TCP / UDP
数据拥塞控制协议：DCCP   流控制传输协议： SCTP
TCP/IP环境中，DNS是一个分布式数据库，DNS是应用层协议
IP地址：点分四组，点分十进制
ipv6的写法，缩写，以及ipv4映射的ipv6，用[]括住ipv6
ipv4 2^32=4 294 967 296

网络号和主机号：Ａ(0)　Ｂ(10)　Ｃ(110) Ｄ(组播 1110)　Ｅ(组播1111)类ip ===》地址的前几位表示
	A  0.0.0.0  ~ 127.255.255.255
	B  128.0.0.0 ~ 191.255.255.255
	C  192.0.0.0 ~ 223.255.255.255
	D  224.0.0.0 ~ 239.255.255.255
	E  240.0.0.0 ~ 255.255.255.255
子网寻址
子网掩码==》形式
		==》路由和主机使用
		==》确定数据能转发到响应的子网中
广播地址：
	子网广播地址的构建
		
EUI：扩展唯一标识符
前缀：CIDR：internet路由系统支持无类别域间路由  《====》CIDR掩码
聚合：
特殊用途的地址：
IPv4加前缀转为ipv6地址
组播地址
单播
netstat -gn

ip地址及组播有太多的疑问~
链路层： ==》为了ip模块的发送和接收，依赖于网络类型，各种有线无线的网络
最大传输单元:MTU
以太网：信号延迟和信号碰撞被检测到,共享介质能收到 --》wifi
MAC协议：介质访问控制(CSMA/CD)


以太网的帧格式？ 原地址，目的地址 （48位6字节）类型字段/长度字段（2字节确定后面类型， ipv4(0x0800) ipv6(0x86dd), arp(ox0806)）+ 其他。。
crc校验
帧大小：最小64字节，数据区最小48字节
		最大震1518字节  MTU大小限制1500字节	
虚拟局域网：VLAN ==》解决网络交换问题，已经被交换机，路由器替代
				==》端口，mac地址
				
vconfig ==》增加或者删除虚拟接口，即与物理接口关联的VLAN ID  ==》物理接口与VLAN ID串联
LACP：链路聚合协议 ==》linux命令协议，实现了接口的平衡。。。
全双工： ethtool eth0 ==>查询是否支持全双工
使用ethtool设置唤醒，达到省电
流量控制 ==》PAUSE消息
交换机/网桥：mac地址学习后，存储一张表，计时器，   ==》两个以太网之间实现互联

问题：网桥的设置及练习  brctl
生成树协议：STP --》抑制放大（禁用一些路，避免循环等）
BPDU:网桥数据协议单元 ===》使STP适应网桥的启用，关闭，接口卡更换mac等
	默认禁用STP
多注册协议：MRP  注册MAC地址。==》不需要广播所有流量获取
wifi：无线以太网的形式     链路层
	==》管理帧探测  (SSID)
	==》iwlist wlan0 scan
控制帧：RTS/CTS(请求发送/明确发送)==>之后打开时间窗口  ==》可禁用或者筏值设置大
		ACK（重传/确认）  ==>组播没有ACK确认，防止ACK爆炸，==》设置标识，重传时间
		iwconfig wlan0 rts 250  重新设置rts的分片筏值  

数据帧： 分片和聚合 （分片号(4位) 序列号(12位)）也提高性能，提高交付成果概率==>每个帧有ack确认重传
	聚合： A-MSDU   A-MPDU
	
wifi时间同步功能(STF)唤醒STA检查等候帧的能力 ===》电源省电
介质访问功能：点协调功能（PCF），分布式协调功能（DCF），混合协调功能（HCF）
信道和频率： ==》电磁波谱
点对点协议：PPP  最后16位的FCS(CRC16)==>协议方式是怎样的？
回环：

MTU：最大传输单元  默认1500字节 ===》以太网有效载荷是1500
隧道： 虚拟链路  VPN  GRE  PPTP

发送数据，不止要知道ip，还要知道物理地址==》arp
如何封装实现获取arp？
	tcpdump -e      命令
	
arp缓存超时
代理arp

问题：根据ipv4， ipv6的定义实现协议栈

网络字节序： 高位优先字节序
	而计算机CPU以其他格式存储二进制整数，在传输时必须将头部转为网络字节序，接收时再赚回来
TPv4协议头中：   UDP(17)   TCP(6)
隧道实现：嵌套
路由头部

动态主机配置协议：DHCP  ==》实现dhcp
			中继代理  dhcp
			广域网连接设备：PPPoE
			
			
防火墙：包过滤防火墙，代理防火墙
网络地址转换：NAT   ===》不同地方可以重复使用ip
	==》ip不够用的问题和防火墙的部分功能
	==》重写ip地址，端口没重写
	NAPT  ==》网络地址接口转换
	
ipv4私有地址：10.0.0.0/8   172.16.0.0/12    192.168.0.0/16==>NAT内部使用

内网穿透 通过nat映射实现的
nat会修改数据的报头的ip
隧道数据包还得修改内部的ip
内部映射 过滤行为
针孔和打孔
STUN会话穿越  ===》如软件电话的应用

internet控制报文
ICMP:ip相关诊断和配置的信息==》由ip层，ip上层
	iPv4报文中 有个控制代表携带ICMP报文 ==》ICMP封装在ip内部
		差错报文==》目的不可达，重定向，超时，参数问题
		信息查询采集报文
	ICMP报文头部及使用
		ping   traceroute
		
	ipv6的邻居请求和通告 和arp目的一样
	校验：CGA选项和RSA签名
	信任锚
	证书
	
	ICMP：泛洪，炸弹，信息泄露
	单播 任播   组播  广播的原理===》IGMP MLD(信令协议)
